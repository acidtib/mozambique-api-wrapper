const fetch=require("node-fetch"),BASE_URL="https://api.mozambiquehe.re",DIRECTORY={SEARCH_URL:BASE_URL+"/bridge?version=",NEWS_URL:BASE_URL+"/news?",SERVER_STATUS:BASE_URL+"/servers?",MATCH_HISTORY:BASE_URL+"/bridge?",GAME_DATA:BASE_URL+"/gamedata?",MAP_ROTATION:BASE_URL+"/maprotation?",ORIGIN:BASE_URL+"/origin?",ANNOUNCEMENTS:"https://apexlegendsstatus.com/anno.json",NAME_TO_UID:BASE_URL+"/nametouid?"};function request(e,r){return fetch(r,{headers:e.headers}).then(function(e){return e.json()}).catch(function(e){return Promise.reject(e)})}class MozambiqueAPI{constructor(e,r=5,t="mozambique-api-wrapper"){if(!e)throw new Error("[ERROR] mozampique-api-wrapper: API Key missing");this.apiKey=e,this.version=r,this.headers={"User-Agent":t,"Content-Type":"application/json",Authorization:this.apiKey}}search(e,r={merge:!1,removeMerged:!1}){let t;return e.player&&(t="player="+e.player),e.uid&&(t="uid="+e.uid),request(this,DIRECTORY.SEARCH_URL+this.version+"&platform="+e.platform+"&"+t+(r.merge?"&merge":"")+(r.removeMerged?"&removeMerged":""))}bulkSearch(e,r={merge:!1,removeMerged:!1}){let t;return e.players&&e.players.length>0&&(t="&player="+e.players.map(e=>e).join(",")),e.uids&&e.uids.length>0&&(t="&uid="+e.uids.map(e=>e).join(",")),request(this,DIRECTORY.SEARCH_URL+this.version+"&platform="+query.platform+t+(r.merge?"&merge":"")+(r.removeMerged?"&removeMerged":""))}news(e="en-us"){return request(this,DIRECTORY.NEWS_URL+"lang="+e)}server(){return request(this,DIRECTORY.SERVER_STATUS)}history(e,r,t=-1,i,s){let a="";if("info"!=e){let e;r.player&&(e="player="+r.player),r.uid&&(e="uid="+r.uid),a=e+"&platform="+r.platform+"&"}let n="";return isNaN(t)||-1==t||(n="&limit="+t),request(this,DIRECTORY.MATCH_HISTORY+a+"history=1&action="+e+n+(null!=i?"&start="+i:"")+(null!=s?"&end"+s:""))}mapRotation(){return request(this,DIRECTORY.MAP_ROTATION)}origin(e,r=!1){return request(this,DIRECTORY.ORIGIN+"player="+e+(r?"&showAllHits":""))}announcements(){return request(this,DIRECTORY.ANNOUNCEMENTS)}nameToUID(e){return request(this,DIRECTORY.NAME_TO_UID+"player="+e.player+"&platform="+e.platform)}gamedata(e){return request(this,DIRECTORY.GAME_DATA+"type="+e)}}module.exports=MozambiqueAPI;